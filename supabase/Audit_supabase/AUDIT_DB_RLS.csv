schemaname,tablename,policyname,permissive,roles,cmd,qual,with_check
"public,abonnements,abonnements_select_entreprise,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.entreprise_id = abonnements.entreprise_id))))"",null"
"public,abonnements,abonnements_select_admin,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin_jtec'::user_role))))"",null"
"public,abonnements,abonnements_admin_all,PERMISSIVE,{public},ALL,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin_jtec'::user_role))))"",null"
"public,abonnements,abonnements_select_regie,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.regie_id = abonnements.regie_id))))"",null"
public,entreprises,Entreprise can view own profile,PERMISSIVE,{public},SELECT,(profile_id = auth.uid()),null
public,entreprises,Entreprise can update own profile,PERMISSIVE,{public},UPDATE,(profile_id = auth.uid()),null
public,entreprises,Entreprise can manage own profile,PERMISSIVE,{public},ALL,(profile_id = auth.uid()),null
public,entreprises,Entreprise can insert own profile,PERMISSIVE,{public},INSERT,null,(profile_id = auth.uid())
public,entreprises,Admin JTEC can view all entreprises,PERMISSIVE,{public},SELECT,is_admin_jtec(),null
"public,entreprises,Regie can view authorized entreprises,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM regies_entreprises
"  WHERE ((regies_entreprises.entreprise_id = entreprises.id) AND (regies_entreprises.regie_id = get_user_regie_id()))))"",null"
"public,factures,factures_entreprise_select,PERMISSIVE,{authenticated},SELECT,""((entreprise_id = ( SELECT profiles.entreprise_id"
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (( SELECT profiles.role
   FROM profiles
"  WHERE (profiles.id = auth.uid())) = 'entreprise'::user_role))"",null"
"public,factures,factures_entreprise_insert,PERMISSIVE,{authenticated},INSERT,null,""((entreprise_id = ( SELECT profiles.entreprise_id"
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (( SELECT profiles.role
   FROM profiles
"  WHERE (profiles.id = auth.uid())) = 'entreprise'::user_role))"""
"public,factures,factures_admin_jtec_all,PERMISSIVE,{authenticated},ALL,""(( SELECT profiles.role"
   FROM profiles
"  WHERE (profiles.id = auth.uid())) = 'admin_jtec'::user_role)"",null"
"public,factures,factures_update,PERMISSIVE,{authenticated},UPDATE,""(((entreprise_id = ( SELECT profiles.entreprise_id"
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (( SELECT profiles.role
   FROM profiles
  WHERE (profiles.id = auth.uid())) = 'entreprise'::user_role)) OR ((regie_id = ( SELECT profiles.regie_id
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (( SELECT profiles.role
   FROM profiles
  WHERE (profiles.id = auth.uid())) = 'regie'::user_role)) OR (( SELECT profiles.role
   FROM profiles
"  WHERE (profiles.id = auth.uid())) = 'admin_jtec'::user_role))"",null"
"public,factures,factures_regie_select,PERMISSIVE,{authenticated},SELECT,""((regie_id = ( SELECT profiles.regie_id"
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (( SELECT profiles.role
   FROM profiles
"  WHERE (profiles.id = auth.uid())) = 'regie'::user_role))"",null"
"public,immeubles,Admin JTEC can view all immeubles,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles p
"  WHERE ((p.id = auth.uid()) AND (p.role = 'admin_jtec'::user_role))))"",null"
"public,immeubles,Regie can manage own immeubles,PERMISSIVE,{public},ALL,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = immeubles.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,immeubles,Regie can view own immeubles,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = immeubles.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,locataires,Regie can insert locataire in own logements,PERMISSIVE,{public},INSERT,null,""(EXISTS ( SELECT 1"
   FROM (logements l
     JOIN immeubles i ON ((i.id = l.immeuble_id)))
"  WHERE ((l.id = locataires.logement_id) AND (i.regie_id = get_user_regie_id()))))"""
public,locataires,Locataire can manage own data,PERMISSIVE,{public},ALL,(profile_id = auth.uid()),null
"public,locataires,Admin JTEC can view all locataires,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles p
"  WHERE ((p.id = auth.uid()) AND (p.role = 'admin_jtec'::user_role))))"",null"
"public,locataires,Regie can view own locataires,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = locataires.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,locataires,Regie can update own locataires,PERMISSIVE,{public},UPDATE,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = locataires.regie_id) AND (r.profile_id = auth.uid()))))"",""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = locataires.regie_id) AND (r.profile_id = auth.uid()))))"""
"public,locataires,Regie can insert own locataires,PERMISSIVE,{public},INSERT,null,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = locataires.regie_id) AND (r.profile_id = auth.uid()))))"""
"public,locataires,Regie can delete own locataires,PERMISSIVE,{public},DELETE,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = locataires.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,logements,Locataire can view only own logement,PERMISSIVE,{public},SELECT,""((( SELECT profiles.role"
   FROM profiles
  WHERE (profiles.id = auth.uid())) = 'locataire'::user_role) AND (id = ( SELECT locataires.logement_id
   FROM locataires
"  WHERE (locataires.profile_id = auth.uid()))))"",null"
"public,logements,Regie can manage own logements,PERMISSIVE,{public},ALL,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = logements.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,logements,Regie can view own logements,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM regies r
"  WHERE ((r.id = logements.regie_id) AND (r.profile_id = auth.uid()))))"",null"
"public,logements,Admin JTEC can view all logements,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles p
"  WHERE ((p.id = auth.uid()) AND (p.role = 'admin_jtec'::user_role))))"",null"
"public,messages,messages_access,PERMISSIVE,{authenticated},ALL,""(EXISTS ( SELECT 1"
   FROM get_mission_actors(messages.mission_id) get_mission_actors(user_id, role)
"  WHERE (messages.id = auth.uid())))"",null"
"public,missions,Technicien can update assigned missions,PERMISSIVE,{public},UPDATE,""(technicien_id = ( SELECT techniciens.id"
   FROM techniciens
"  WHERE (techniciens.profile_id = auth.uid())))"",null"
"public,missions,Admin JTEC can view all missions,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin_jtec'::user_role))))"",null"
"public,missions,Entreprise can update own missions,PERMISSIVE,{public},UPDATE,""(entreprise_id = ( SELECT entreprises.id"
   FROM entreprises
"  WHERE (entreprises.profile_id = auth.uid())))"",null"
"public,missions,Entreprise can view own missions,PERMISSIVE,{public},SELECT,""(entreprise_id = ( SELECT entreprises.id"
   FROM entreprises
"  WHERE (entreprises.profile_id = auth.uid())))"",null"
"public,missions,Locataire can view missions for own tickets,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM (tickets t
     JOIN locataires loc ON ((t.locataire_id = loc.id)))
"  WHERE ((missions.ticket_id = t.id) AND (loc.profile_id = auth.uid()))))"",null"
"public,missions,Regie can update missions for own tickets,PERMISSIVE,{public},UPDATE,""(EXISTS ( SELECT 1"
   FROM ((tickets t
     JOIN logements l ON ((t.logement_id = l.id)))
     JOIN immeubles i ON ((l.immeuble_id = i.id)))
"  WHERE ((missions.ticket_id = t.id) AND (i.regie_id = get_user_regie_id()))))"",null"
"public,missions,Regie can view missions for own tickets,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM ((tickets t
     JOIN logements l ON ((t.logement_id = l.id)))
     JOIN immeubles i ON ((l.immeuble_id = i.id)))
"  WHERE ((missions.ticket_id = t.id) AND (i.regie_id = get_user_regie_id()))))"",null"
"public,missions,Technicien can view assigned missions,PERMISSIVE,{public},SELECT,""(technicien_id = ( SELECT techniciens.id"
   FROM techniciens
"  WHERE (techniciens.profile_id = auth.uid())))"",null"
public,notifications,notifications_own,PERMISSIVE,{authenticated},ALL,(user_id = auth.uid()),null
public,plans,plans_select_all,PERMISSIVE,{public},SELECT,true,null
"public,plans,plans_admin_all,PERMISSIVE,{public},ALL,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin_jtec'::user_role))))"",null"
public,profiles,Admin JTEC can manage all profiles,PERMISSIVE,{public},ALL,is_admin_jtec(),null
public,profiles,Users can view own profile,PERMISSIVE,{public},SELECT,(auth.uid() = id),null
public,profiles,Users can update own profile,PERMISSIVE,{public},UPDATE,(auth.uid() = id),null
public,regies,Regie can view own regie,PERMISSIVE,{public},SELECT,(profile_id = auth.uid()),null
public,regies,Regie can manage own regie,PERMISSIVE,{public},ALL,(profile_id = auth.uid()),null
public,regies,Regie can update own regie,PERMISSIVE,{public},UPDATE,(profile_id = auth.uid()),null
public,regies,Regie can insert own regie,PERMISSIVE,{public},INSERT,null,(profile_id = auth.uid())
public,regies,Admin JTEC can manage all regies,PERMISSIVE,{public},ALL,is_admin_jtec(),null
public,regies_entreprises,Regie can delete authorizations,PERMISSIVE,{public},DELETE,(regie_id = get_user_regie_id()),null
public,regies_entreprises,Admin JTEC can view all authorizations,PERMISSIVE,{public},SELECT,is_admin_jtec(),null
"public,regies_entreprises,Entreprise can view own authorizations,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM entreprises
"  WHERE ((entreprises.id = regies_entreprises.entreprise_id) AND (entreprises.profile_id = auth.uid()))))"",null"
public,regies_entreprises,Regie can create authorizations,PERMISSIVE,{public},INSERT,null,(regie_id = get_user_regie_id())
public,regies_entreprises,Regie can manage authorizations,PERMISSIVE,{public},ALL,(regie_id = get_user_regie_id()),null
public,regies_entreprises,Regie can update authorizations,PERMISSIVE,{public},UPDATE,(regie_id = get_user_regie_id()),null
public,regies_entreprises,Regie can view own authorizations,PERMISSIVE,{public},SELECT,(regie_id = get_user_regie_id()),null
public,techniciens,Technicien can update own profile,PERMISSIVE,{public},UPDATE,(profile_id = auth.uid()),null
"public,techniciens,Entreprise can update own techniciens,PERMISSIVE,{public},UPDATE,""(entreprise_id = ( SELECT entreprises.id"
   FROM entreprises
"  WHERE (entreprises.profile_id = auth.uid())))"",null"
"public,techniciens,Entreprise can insert own techniciens,PERMISSIVE,{public},INSERT,null,""(entreprise_id = ( SELECT entreprises.id"
   FROM entreprises
"  WHERE (entreprises.profile_id = auth.uid())))"""
"public,techniciens,Admin JTEC can view all techniciens,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM profiles
"  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin_jtec'::user_role))))"",null"
public,techniciens,Technicien can view own profile,PERMISSIVE,{public},SELECT,(profile_id = auth.uid()),null
"public,techniciens,Entreprise can view own techniciens,PERMISSIVE,{public},SELECT,""(entreprise_id = ( SELECT entreprises.id"
   FROM entreprises
"  WHERE (entreprises.profile_id = auth.uid())))"",null"
"public,techniciens,Regie can view techniciens of authorized entreprises,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM regies_entreprises
"  WHERE ((regies_entreprises.entreprise_id = techniciens.entreprise_id) AND (regies_entreprises.regie_id = get_user_regie_id()))))"",null"
"public,tickets,Locataire can create own tickets,PERMISSIVE,{public},INSERT,null,""(EXISTS ( SELECT 1"
   FROM locataires
"  WHERE ((locataires.id = tickets.locataire_id) AND (locataires.profile_id = auth.uid()))))"""
public,tickets,Admin JTEC can view all tickets,PERMISSIVE,{public},SELECT,is_admin_jtec(),null
"public,tickets,Locataire can view own tickets,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM locataires
"  WHERE ((locataires.id = tickets.locataire_id) AND (locataires.profile_id = auth.uid()))))"",null"
public,tickets,Regie can manage own tickets,PERMISSIVE,{public},ALL,(regie_id = get_user_regie_id()),null
public,tickets,Regie can view own tickets,PERMISSIVE,{public},SELECT,(regie_id = get_user_regie_id()),null
"public,tickets,Locataire can manage own tickets,PERMISSIVE,{public},ALL,""(EXISTS ( SELECT 1"
   FROM locataires
"  WHERE ((locataires.id = tickets.locataire_id) AND (locataires.profile_id = auth.uid()))))"",null"
"public,tickets,Entreprise can view authorized tickets,PERMISSIVE,{public},SELECT,""(EXISTS ( SELECT 1"
   FROM (entreprises e
     JOIN regies_entreprises re ON ((re.entreprise_id = e.id)))
"  WHERE ((e.profile_id = auth.uid()) AND (re.regie_id = tickets.regie_id))))"",null"
