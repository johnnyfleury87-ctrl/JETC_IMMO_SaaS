================================================================================
ğŸ¯ GUIDE RAPIDE - APPLICATION MIGRATION M50
================================================================================

ğŸ“Œ Ã‰TAPE 1 : Ouvrir l'Ã©diteur SQL Supabase
--------------------------------------------------------------------------------

URL : https://bwzyajsrmfhrxdmfpyqy.supabase.co/project/_/sql/new

ou

Dashboard â†’ SQL Editor â†’ New Query


ğŸ“Œ Ã‰TAPE 2 : Copier le contenu du fichier de migration
--------------------------------------------------------------------------------

Fichier : /workspaces/JETC_IMMO_SaaS/supabase/migrations/20260107120000_m50_workflow_facturation_complet.sql

Copier TOUT le contenu (575 lignes)


ğŸ“Œ Ã‰TAPE 3 : Coller dans l'Ã©diteur SQL Supabase
--------------------------------------------------------------------------------

Coller le contenu dans l'Ã©diteur


ğŸ“Œ Ã‰TAPE 4 : ExÃ©cuter
--------------------------------------------------------------------------------

Cliquer sur le bouton "Run" (en bas Ã  droite)


ğŸ“Œ Ã‰TAPE 5 : VÃ©rifier les rÃ©sultats
--------------------------------------------------------------------------------

âœ… Ignorer les messages "already exists" (normaux)
âœ… VÃ©rifier qu'il n'y a pas d'erreurs fatales (en rouge)


ğŸ“Œ Ã‰TAPE 6 : Tester l'application
--------------------------------------------------------------------------------

Dans le terminal VSCode, exÃ©cuter :

```bash
node _test_workflow_facturation.js
```

Ce script va :
  âœ… VÃ©rifier que tous les RPC existent
  âœ… VÃ©rifier les colonnes ajoutÃ©es
  âœ… VÃ©rifier la vue missions_factures_complet
  âœ… Tester la gÃ©nÃ©ration de facture (si mission disponible)


================================================================================
ğŸ‰ SI TOUT EST OK
================================================================================

Tous les tests doivent passer :
  âœ… RPC (start_mission, complete_mission, etc.)
  âœ… Colonnes (iban, duree_minutes)
  âœ… Vue missions_factures_complet
  âœ… Workflow complet

â†’ Passer aux adaptations frontend (voir _FINALISATION_WORKFLOW_FACTURATION.md)


================================================================================
âŒ SI ERREUR
================================================================================

Erreurs possibles :

1. "permission denied" ou "access denied"
   â†’ VÃ©rifier que vous Ãªtes connectÃ© avec compte admin Supabase

2. "function already exists"
   â†’ Normal, ignorer (script inclut DROP IF EXISTS)

3. "column already exists"
   â†’ Normal, ignorer (script inclut IF NOT EXISTS)

4. "table does not exist"
   â†’ ERREUR CRITIQUE : SchÃ©ma de base manquant
   â†’ VÃ©rifier que schema/13_missions.sql et 15_facturation.sql ont Ã©tÃ© appliquÃ©s


================================================================================
ğŸ“ AIDE
================================================================================

En cas de problÃ¨me :
1. Copier les logs d'erreur
2. VÃ©rifier dans Supabase Dashboard â†’ Database â†’ Tables si :
   - Table "missions" existe
   - Table "factures" existe
3. RÃ©-exÃ©cuter le script de test : node _test_workflow_facturation.js
