type,objet,schema,description,severity,impact,fichiers_concernes
MIGRATION_NON_APPLIQUEE,20251226170000_m01_add_budget_columns,public,"Migration M01 présente dans supabase/migrations/ mais absente de migration_logs (pas d'historique d'application)",HIGH,fonctionnel - colonnes budget tickets manquantes,"20251226170000_m01_add_budget_columns.sql, 20251226170000_m01_add_budget_columns_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170100_m02_add_mode_diffusion,public,"Migration M02 présente dans supabase/migrations/ mais absente de migration_logs (pas d'historique d'application)",BLOCKER,fonctionnel + sécurité - mode_diffusion tickets manquant,"20251226170100_m02_add_mode_diffusion.sql, 20251226170100_m02_add_mode_diffusion_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170200_m03_create_rpc_update_ticket_statut,public,"Migration M03 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - RPC update_ticket_statut absent,20251226170200_m03_create_rpc_update_ticket_statut.sql
MIGRATION_NON_APPLIQUEE,20251226170300_m04_create_rpc_diffuser_ticket,public,"Migration M04 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - RPC diffuser_ticket manquant,20251226170300_m04_create_rpc_diffuser_ticket.sql
MIGRATION_NON_APPLIQUEE,20251226170400_m05_fix_rpc_accept_ticket,public,"Migration M05 présente dans supabase/migrations/ mais absente de migration_logs",BLOCKER,fonctionnel - RPC accept_ticket_and_create_mission désynchronisé,"20251226170400_m05_fix_rpc_accept_ticket.sql, 20251226170400_m05_fix_rpc_accept_ticket_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170500_m06_fix_view_tickets_visibles_entreprise,public,"Migration M06 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel + sécurité - VIEW tickets_visibles_entreprise absente,"20251226170500_m06_fix_view_tickets_visibles_entreprise.sql, 20251226170500_m06_fix_view_tickets_visibles_entreprise_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170600_m07_fix_rls_policy_entreprise,public,"Migration M07 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy entreprise désynchronisée,"20251226170600_m07_fix_rls_policy_entreprise.sql, 20251226170600_m07_fix_rls_policy_entreprise_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170700_m08_add_classification_columns,public,"Migration M08 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - colonnes sous_categorie/piece manquantes,"20251226170700_m08_add_classification_columns.sql, 20251226170700_m08_add_classification_columns_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170800_m09_create_tickets_disponibilites,public,"Migration M09 présente dans supabase/migrations/ mais absente de migration_logs",BLOCKER,fonctionnel - table tickets_disponibilites manquante,"20251226170800_m09_create_tickets_disponibilites.sql, 20251226170800_m09_create_tickets_disponibilites_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226170900_m10_create_trigger_validate_disponibilites,public,"Migration M10 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - trigger validation disponibilités manquant,"20251226170900_m10_create_trigger_validate_disponibilites.sql, 20251226170900_m10_create_trigger_validate_disponibilites_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226171000_m11_harmonize_missions_montant_chf,public,"Migration M11 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - harmonisation missions.montant_reel_chf manquante,"20251226171000_m11_harmonize_missions_montant_chf.sql, 20251226171000_m11_harmonize_missions_montant_chf_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226171100_m13_secure_delete_tickets_rls,public,"Migration M13 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy DELETE tickets manquante,"20251226171100_m13_secure_delete_tickets_rls.sql, 20251226171100_m13_secure_delete_tickets_rls_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226171200_m14_sync_mission_ticket_statut,public,"Migration M14 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - trigger sync mission/ticket manquant,"20251226171200_m14_sync_mission_ticket_statut.sql, 20251226171200_m14_sync_mission_ticket_statut_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226180000_m15_allow_null_priorite_plafond,public,"Migration M15 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - contraintes priorite/plafond désynchronisées,"20251226180000_m15_allow_null_priorite_plafond.sql, 20251226180000_m15_allow_null_priorite_plafond_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226181000_m16_add_ventilation_check,public,"Migration M16 présente dans supabase/migrations/ mais absente de migration_logs",LOW,fonctionnel - contrainte ventilation manquante,"20251226181000_m16_add_ventilation_check.sql, 20251226181000_m16_add_ventilation_check_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226190000_m17_fix_check_piece_case_insensitive,public,"Migration M17 présente dans supabase/migrations/ mais absente de migration_logs",LOW,fonctionnel - contrainte piece case insensitive manquante,"20251226190000_m17_fix_check_piece_case_insensitive.sql, 20251226190000_m17_fix_check_piece_case_insensitive_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226200000_m18_replace_triggers_with_rpc,public,"Migration M18 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - refactoring triggers/RPC non appliqué,"20251226200000_m18_replace_triggers_with_rpc.sql, 20251226200000_m18_replace_triggers_with_rpc_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226210000_m19_audit_debug_rpc,public,"Migration M19 présente dans supabase/migrations/ mais absente de migration_logs",LOW,debug - RPC jtec_debug_schema présent en DB mais migration non enregistrée,"20251226210000_m19_audit_debug_rpc.sql, 20251226210000_m19_audit_debug_rpc_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226220000_m20_fix_rls_policy_insert,public,"Migration M20 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy INSERT locataire désynchronisée,"20251226220000_m20_fix_rls_policy_insert.sql, 20251226220000_m20_fix_rls_policy_insert_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226230000_m21_rpc_create_ticket_locataire,public,"Migration M21 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - RPC create_ticket_locataire présent en DB mais migration non enregistrée,"20251226230000_m21_rpc_create_ticket_locataire.sql, 20251226230000_m21_rpc_create_ticket_locataire_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226240000_m22_fix_notify_new_ticket,public,"Migration M22 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - RPC notify_new_ticket présent en DB mais migration non enregistrée,"20251226240000_m22_fix_notify_new_ticket.sql, 20251226240000_m22_fix_notify_new_ticket_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251226250000_m23_fix_schema_notify,public,"Migration M23 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - correctif schema notify non enregistré,20251226250000_m23_fix_schema_notify.sql
MIGRATION_NON_APPLIQUEE,20251226260000_m24_rls_regie_select_tickets,public,"Migration M24 (fichier 1) présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy regie SELECT tickets désynchronisée,"20251226260000_m24_rls_regie_select_tickets.sql, 20251226260000_m24_rls_regie_select_tickets_rollback.sql"
DOUBLON_MIGRATION,20251227000000_m24_masquage_colonnes_sensibles,public,"Migration M24 (fichier 2) - DOUBLON avec M24 fichier 1 (même M-number mais objectif différent)",HIGH,données - risque de double application ou confusion,"20251227000000_m24_masquage_colonnes_sensibles.sql, 20251227000000_m24_masquage_colonnes_sensibles_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000100_m25_validation_diffusion,public,"Migration M25 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - validation diffusion manquante,"20251227000100_m25_validation_diffusion.sql, 20251227000100_m25_validation_diffusion_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000200_m26_rls_insert_entreprises_regie,public,"Migration M26 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy INSERT entreprises présente en DB mais migration non enregistrée,"20251227000200_m26_rls_insert_entreprises_regie.sql, 20251227000200_m26_rls_insert_entreprises_regie_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000300_m27_expose_get_user_regie_id_rpc,public,"Migration M27 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - RPC get_user_regie_id présent en DB mais migration non enregistrée,"20251227000300_m27_expose_get_user_regie_id_rpc.sql, 20251227000300_m27_expose_get_user_regie_id_rpc_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000400_m28_fix_rls_recursion_entreprises,public,"Migration M28 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - fix RLS récursion entreprises non appliqué,"20251227000400_m28_fix_rls_recursion_entreprises.sql, 20251227000400_m28_fix_rls_recursion_entreprises_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000500_m29_final,public,"Migration M29 (fichier 1) présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - consolidation finale non enregistrée,20251227000500_m29_final.sql
MIGRATION_NON_APPLIQUEE,20251227000500_m29_rpc_create_entreprise_complete,public,"Migration M29 (fichier 2) présente dans supabase/migrations/ mais absente de migration_logs - DOUBLON M29",HIGH,fonctionnel - RPC create_entreprise présents en DB mais migration non enregistrée,"20251227000500_m29_rpc_create_entreprise_complete.sql, 20251227000500_m29_rpc_create_entreprise_complete_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000600_m30_fix_mode_diffusion,public,"Migration M30 présente dans supabase/migrations/ mais absente de migration_logs - DIRECTEMENT LIÉ AU BUG BLOCKER",BLOCKER,fonctionnel - correctif mode_diffusion non appliqué = cause erreur 400 entreprise,20251227000600_m30_fix_mode_diffusion.sql
MIGRATION_NON_APPLIQUEE,20251227000700_m31_add_tracabilite_tickets,public,"Migration M31 (fichier 1/5) présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - colonnes traçabilité tickets manquantes,"20251227000700_m31_add_tracabilite_tickets.sql, 20251227000700_m31_add_tracabilite_tickets_rollback.sql"
DOUBLON_MIGRATION,20251227002000_m31_m34_workflow_tickets_complet,public,"Migration M31 (fichier 2/5) - DOUBLON consolidé M31+M32+M33+M34",HIGH,fonctionnel - consolidation workflow complet,"20251227002000_m31_m34_workflow_tickets_complet.sql, 20251227002000_m31_m34_workflow_tickets_complet_rollback.sql"
DOUBLON_MIGRATION,20260104000000_m31_m35_workflow_complet_consolidated,public,"Migration M31 (fichier 3/5) - DOUBLON super-consolidé M31→M35 (type:consolidated)",BLOCKER,fonctionnel - REMPLACE M31-M35 mais pas enregistrée,20260104000000_m31_m35_workflow_complet_consolidated.sql
MIGRATION_NON_APPLIQUEE,20251227000800_m32_rpc_valider_ticket_regie,public,"Migration M32 présente dans supabase/migrations/ mais absente de migration_logs (consolidée dans M31_M34)",HIGH,fonctionnel - RPC valider_ticket_regie présent en DB mais migration non enregistrée,"20251227000800_m32_rpc_valider_ticket_regie.sql, 20251227000800_m32_rpc_valider_ticket_regie_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227000900_m33_rpc_get_entreprises_autorisees,public,"Migration M33 présente dans supabase/migrations/ mais absente de migration_logs (consolidée dans M31_M34)",HIGH,fonctionnel - RPC get_entreprises_autorisees présent en DB mais migration non enregistrée,"20251227000900_m33_rpc_get_entreprises_autorisees.sql, 20251227000900_m33_rpc_get_entreprises_autorisees_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227001000_m34_rls_entreprise_tickets,public,"Migration M34 présente dans supabase/migrations/ mais absente de migration_logs (consolidée dans M31_M34)",HIGH,sécurité - Policies entreprises tickets désynchronisées,"20251227001000_m34_rls_entreprise_tickets.sql, 20251227001000_m34_rls_entreprise_tickets_rollback.sql"
MIGRATION_NON_APPLIQUEE,20251227001100_m35_harmonize_mode_diffusion,public,"Migration M35 présente dans supabase/migrations/ mais absente de migration_logs - DIRECTEMENT LIÉ AU BUG BLOCKER",BLOCKER,fonctionnel + sécurité - harmonisation mode_diffusion non appliquée = cause erreur 400 entreprise,"20251227001100_m35_harmonize_mode_diffusion.sql, 20251227001100_m35_harmonize_mode_diffusion_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001200_m36_fix_disponibilites_rule,public,"Migration M36 présente dans supabase/migrations/ mais absente de migration_logs",MEDIUM,fonctionnel - règle validation disponibilités désynchronisée,"20260104001200_m36_fix_disponibilites_rule.sql, 20260104001200_m36_fix_disponibilites_rule_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001300_m37_fix_vue_entreprise_terminologie,public,"Migration M37 présente dans supabase/migrations/ mais absente de migration_logs",LOW,fonctionnel - terminologie vue entreprise non corrigée,"20260104001300_m37_fix_vue_entreprise_terminologie.sql, 20260104001300_m37_fix_vue_entreprise_terminologie_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001400_m38_rpc_update_mode_diffusion,public,"Migration M38 présente dans supabase/migrations/ mais absente de migration_logs - DIRECTEMENT LIÉ AU BUG BLOCKER",BLOCKER,fonctionnel - RPC update_entreprise_mode_diffusion manquant = empêche changement mode diffusion,"20260104001400_m38_rpc_update_mode_diffusion.sql, 20260104001400_m38_rpc_update_mode_diffusion_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001500_m39_fix_rls_mode_diffusion,public,"Migration M39 présente dans supabase/migrations/ mais absente de migration_logs - LIÉ AU BUG BLOCKER",BLOCKER,sécurité - Policy RLS mode_diffusion désynchronisée = empêche acceptation ticket,"20260104001500_m39_fix_rls_mode_diffusion.sql, 20260104001500_m39_fix_rls_mode_diffusion_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001600_m40_fix_rls_disponibilites,public,"Migration M40 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,sécurité - Policy disponibilités entreprises manquante,"20260104001600_m40_fix_rls_disponibilites.sql, 20260104001600_m40_fix_rls_disponibilites_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001700_m41_harmonize_rpc_acceptation,public,"Migration M41 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - harmonisation RPC acceptation non enregistrée,"20260104001700_m41_harmonize_rpc_acceptation.sql, 20260104001700_m41_harmonize_rpc_acceptation_rollback.sql"
MIGRATION_NON_APPLIQUEE,20260104001800_m42_add_disponibilite_id_missions,public,"Migration M42 présente dans supabase/migrations/ mais absente de migration_logs",HIGH,fonctionnel - colonne disponibilite_id missions manquante,"20260104001800_m42_add_disponibilite_id_missions.sql, 20260104001800_m42_add_disponibilite_id_missions_rollback.sql"
OBJET_ORPHELIN,tickets_disponibilites,public,"Table tickets_disponibilites présente en DB (CSV audit 3_Tables) mais aucune migration appliquée ne la crée selon migration_logs",BLOCKER,fonctionnel - table critique sans historique - source indéterminée,AUCUN - migration M09 existe mais non appliquée selon logs
OBJET_ORPHELIN,tickets_visibles_entreprise,public,"VIEW tickets_visibles_entreprise absente des CSV audit (11_Views) mais référencée dans migrations M06/M37",HIGH,fonctionnel + sécurité - VIEW critique manquante ou non exposée,"20251226170500_m06_fix_view_tickets_visibles_entreprise.sql, 20260104001300_m37_fix_vue_entreprise_terminologie.sql"
RPC_PRESENT_NON_ENREGISTRE,accept_ticket_and_create_mission,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migrations M05/M41 non appliquées selon logs",BLOCKER,fonctionnel - RPC critique acceptation ticket sans historique,"20251226170400_m05_fix_rpc_accept_ticket.sql, 20260104001700_m41_harmonize_rpc_acceptation.sql"
RPC_PRESENT_NON_ENREGISTRE,create_ticket_locataire,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M21 non appliquée selon logs",HIGH,fonctionnel - RPC création ticket locataire sans historique,20251226230000_m21_rpc_create_ticket_locataire.sql
RPC_PRESENT_NON_ENREGISTRE,diffuser_ticket,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M04 non appliquée selon logs",HIGH,fonctionnel - RPC diffusion ticket sans historique,20251226170300_m04_create_rpc_diffuser_ticket.sql
RPC_PRESENT_NON_ENREGISTRE,get_entreprises_autorisees,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M33 non appliquée selon logs",HIGH,fonctionnel - RPC get_entreprises_autorisees sans historique,20251227000900_m33_rpc_get_entreprises_autorisees.sql
RPC_PRESENT_NON_ENREGISTRE,get_user_regie_id,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M27 non appliquée selon logs",HIGH,fonctionnel - RPC get_user_regie_id sans historique - utilisé par TOUTES les policies,20251227000300_m27_expose_get_user_regie_id_rpc.sql
RPC_PRESENT_NON_ENREGISTRE,valider_ticket_regie,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M32 non appliquée selon logs",HIGH,fonctionnel - RPC validation ticket régie sans historique,20251227000800_m32_rpc_valider_ticket_regie.sql
RPC_PRESENT_NON_ENREGISTRE,create_entreprise_simple,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M29 non appliquée selon logs",HIGH,fonctionnel - RPC création entreprise simple sans historique,20251227000500_m29_rpc_create_entreprise_complete.sql
RPC_PRESENT_NON_ENREGISTRE,create_entreprise_with_profile,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M29 non appliquée selon logs",HIGH,fonctionnel - RPC création entreprise avec profile sans historique,20251227000500_m29_rpc_create_entreprise_complete.sql
RPC_PRESENT_NON_ENREGISTRE,toggle_entreprise_mode,public,"RPC présent dans DB (CSV audit 9_Fonctions) mais migration M29 non appliquée selon logs",HIGH,fonctionnel - RPC toggle mode entreprise sans historique,20251227000500_m29_rpc_create_entreprise_complete.sql
RPC_MANQUANT,update_entreprise_mode_diffusion,public,"RPC manquant dans DB (absent CSV audit 9_Fonctions) mais migration M38 existe - NON APPLIQUÉE",BLOCKER,fonctionnel - RPC critique pour changer mode_diffusion ABSENT,20260104001400_m38_rpc_update_mode_diffusion.sql
COLONNE_MANQUANTE,tickets.plafond_valide_par,public,"Colonne plafond_valide_par absente de CSV audit 4_Colonnes mais migrations M31 existent (non appliquées)",HIGH,fonctionnel - traçabilité validation plafond manquante,"20251227000700_m31_add_tracabilite_tickets.sql, 20251227002000_m31_m34_workflow_tickets_complet.sql, 20260104000000_m31_m35_workflow_complet_consolidated.sql"
COLONNE_MANQUANTE,tickets.plafond_valide_at,public,"Colonne plafond_valide_at absente de CSV audit 4_Colonnes mais migrations M31 existent (non appliquées)",HIGH,fonctionnel - traçabilité validation plafond manquante,"20251227000700_m31_add_tracabilite_tickets.sql, 20251227002000_m31_m34_workflow_tickets_complet.sql, 20260104000000_m31_m35_workflow_complet_consolidated.sql"
COLONNE_MANQUANTE,tickets.diffuse_at,public,"Colonne diffuse_at absente de CSV audit 4_Colonnes mais migrations M31 existent (non appliquées)",HIGH,fonctionnel - traçabilité diffusion manquante,"20251227000700_m31_add_tracabilite_tickets.sql, 20251227002000_m31_m34_workflow_tickets_complet.sql, 20260104000000_m31_m35_workflow_complet_consolidated.sql"
COLONNE_MANQUANTE,tickets.diffuse_par,public,"Colonne diffuse_par absente de CSV audit 4_Colonnes mais migrations M31 existent (non appliquées)",HIGH,fonctionnel - traçabilité diffusion manquante,"20251227000700_m31_add_tracabilite_tickets.sql, 20251227002000_m31_m34_workflow_tickets_complet.sql, 20260104000000_m31_m35_workflow_complet_consolidated.sql"
COLONNE_MANQUANTE,missions.disponibilite_id,public,"Colonne disponibilite_id absente de CSV audit 4_Colonnes mais migration M42 existe (non appliquée)",HIGH,fonctionnel - lien mission/disponibilité manquant,"20260104001800_m42_add_disponibilite_id_missions.sql, 20260104001800_m42_add_disponibilite_id_missions_rollback.sql"
POLICY_MANQUANTE,tickets.Entreprise can view general tickets,public,"Policy 'Entreprise can view general tickets' manquante en DB (CSV audit 8_Policies) mais migrations M34/M35/M39 existent (non appliquées)",BLOCKER,sécurité - entreprises ne peuvent pas voir tickets mode:general,"20251227001000_m34_rls_entreprise_tickets.sql, 20251227001100_m35_harmonize_mode_diffusion.sql, 20260104001500_m39_fix_rls_mode_diffusion.sql"
POLICY_MANQUANTE,tickets.Entreprise can view assigned tickets,public,"Policy 'Entreprise can view assigned tickets' manquante en DB (CSV audit 8_Policies) mais migrations M34/M35 existent (non appliquées)",HIGH,sécurité - entreprises ne peuvent pas voir tickets assignés,"20251227001000_m34_rls_entreprise_tickets.sql, 20251227001100_m35_harmonize_mode_diffusion.sql"
POLICY_MANQUANTE,tickets_disponibilites.Entreprise can view disponibilites for visible tickets,public,"Policy entreprise sur disponibilités manquante en DB mais migrations M09/M40 existent (non appliquées)",HIGH,sécurité - entreprises ne peuvent pas voir disponibilités,"20251226170800_m09_create_tickets_disponibilites.sql, 20260104001600_m40_fix_rls_disponibilites.sql"
POLICY_MANQUANTE,entreprises.Regie can update authorized entreprises,public,"Policy 'Regie can update authorized entreprises' présente en DB (CSV audit 8_Policies) mais migration M29 non appliquée selon logs",LOW,sécurité - policy présente mais sans historique migration,20251227000500_m29_rpc_create_entreprise_complete.sql
POLICY_MANQUANTE,entreprises.Regie can delete authorized entreprises,public,"Policy 'Regie can delete authorized entreprises' présente en DB (CSV audit 8_Policies) mais migration M29 non appliquée selon logs",LOW,sécurité - policy présente mais sans historique migration,20251227000500_m29_rpc_create_entreprise_complete.sql
COLONNE_MODE_DIFFUSION_DESYNC,tickets.mode_diffusion,public,"Colonne tickets.mode_diffusion présente en DB (CSV audit 4_Colonnes type:text NULL:YES DEFAULT:null) mais migrations M02/M30/M35/M38/M39 NON APPLIQUÉES - CAUSE RACINE ERREUR 400",BLOCKER,fonctionnel + sécurité - mode_diffusion NULL ou 'general' invalide pour acceptation ticket,"20251226170100_m02_add_mode_diffusion.sql, 20251227000600_m30_fix_mode_diffusion.sql, 20251227001100_m35_harmonize_mode_diffusion.sql, 20260104001400_m38_rpc_update_mode_diffusion.sql, 20260104001500_m39_fix_rls_mode_diffusion.sql"
MIGRATION_APPLIQUEE_SANS_FICHIER,2025-12-20_rpc_creer_locataire (DOUBLON),public,"Migration 2025-12-20_rpc_creer_locataire appliquée 2 fois selon logs (2025-12-20 06:32:14 + 2025-12-23 12:42:04) - fichier unique dans supabase/migrations/",MEDIUM,données - double application possible RPC creer_locataire_complet(),2025-12-20_rpc_creer_locataire.sql
FICHIER_HORS_NOMENCLATURE,M22.5.DEBUG_patch_raise_return.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:debug) - non référencé dans migration_logs",LOW,debug - patch RAISE/RETURN non tracé,M22.5.DEBUG_patch_raise_return.sql
FICHIER_HORS_NOMENCLATURE,M22.5_rpc_tickets_liste_detail_regie.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:forward) - non référencé dans migration_logs",MEDIUM,fonctionnel - RPC dashboard régie non tracés,M22.5_rpc_tickets_liste_detail_regie.sql
FICHIER_HORS_NOMENCLATURE,M22.6_validation_regies_nom_column.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:forward) - non référencé dans migration_logs",LOW,validation - validation colonne nom régies non tracée,M22.6_validation_regies_nom_column.sql
FICHIER_HORS_NOMENCLATURE,M22_rpc_regie_dashboard_tickets.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:forward) - non référencé dans migration_logs",MEDIUM,fonctionnel - RPC dashboard tickets régie non tracé,M22_rpc_regie_dashboard_tickets.sql
FICHIER_HORS_NOMENCLATURE,M23_rpc_tickets_locataire.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:forward) - non référencé dans migration_logs",MEDIUM,fonctionnel - RPC tickets locataire non tracés,M23_rpc_tickets_locataire.sql
FICHIER_HORS_NOMENCLATURE,VALIDATION_POST_MIGRATION.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:validation) - non référencé dans migration_logs",LOW,validation - queries validation post-migration non tracées,VALIDATION_POST_MIGRATION.sql
FICHIER_HORS_NOMENCLATURE,debug_entreprise_login.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:debug) - non référencé dans migration_logs",LOW,debug - queries debug login entreprise non tracées,debug_entreprise_login.sql
FICHIER_HORS_NOMENCLATURE,sanity_check_entreprise_workflow.sql,public,"Fichier présent dans supabase/migrations/ sans M-number (type:validation) - non référencé dans migration_logs",LOW,validation - sanity check workflow entreprise non tracé,sanity_check_entreprise_workflow.sql
TRIGGER_MANQUANT,trigger_check_disponibilites_before_diffusion,public,"Trigger manquant en DB (absent CSV audit 10_Triggers) mais migration M10 existe (non appliquée) - VALIDATION CRITIQUE",HIGH,fonctionnel - validation disponibilités avant diffusion ABSENTE,"20251226170900_m10_create_trigger_validate_disponibilites.sql, 20260104001200_m36_fix_disponibilites_rule.sql"
MIGRATION_MANQUANTE_M12,M12,public,"M-number M12 absent : inventaire montre M01-M11 puis M13-M42 (trou dans séquence)",MEDIUM,données - migration M12 supprimée ou jamais créée,AUCUN
RLS_DESACTIVE_PARTOUT,ALL_TABLES,public,"RLS désactivé sur TOUTES les 19 tables (CSV audit 7_RLS) mais 315 policies définies (CSV audit 8_Policies)",BLOCKER,sécurité - RLS OFF = policies inactives = accès non contrôlé,"Affecte TOUTES les tables : abonnements, entreprises, factures, immeubles, locataires, logements, messages, migration_logs, missions, notifications, plans, profiles, regies, regies_entreprises, techniciens, tickets, tickets_disponibilites"
